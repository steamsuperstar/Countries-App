<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Equal Earth World Map (D3.js)</title>
    <style>
      :root {
        color-scheme: light;
        font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
      }

      body {
        margin: 0;
        padding: 0;
        background: #f7f7fb;
        color: #1f2933;
      }

      h1 {
        margin-bottom: 0.5rem;
        font-size: clamp(1.5rem, 2vw + 1rem, 2.2rem);
      }

      p {
        max-width: 760px;
        line-height: 1.5;
      }

      .map-card {
        background: #ffffff;
        border-radius: 0;
        box-shadow: none;
        padding: 12px;
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .map-shell {
        position: relative;
        flex: 1 1 auto;
        min-height: 0;
      }

      svg {
        width: 100%;
        height: 100%;
        display: block;
      }

      .country {
        fill: #c9d6f2;
        stroke: #52637a;
        stroke-width: 0.4;
        cursor: pointer;
        transition: fill 150ms ease-in-out;
      }

      .country:hover {
        fill: #8fb0ff;
      }

      .country.is-selected {
        fill: #f97316;
      }

      .region {
        fill: #c9f0d3;
        stroke: #2f855a;
        stroke-width: 0.7;
        cursor: pointer;
        transition: fill 150ms ease-in-out;
      }

      .region:hover {
        fill: #8de1aa;
      }

      .region.is-selected {
        fill: #10b981;
      }

      .subregion {
        fill: #cde8f9;
        stroke: #285a84;
        stroke-width: 0.6;
        cursor: pointer;
        transition: fill 150ms ease-in-out;
      }

      .subregion:hover {
        fill: #7fc4f0;
      }

      .subregion.is-selected {
        fill: #0ea5e9;
      }

      .label {
        fill: #1d3557;
        text-anchor: middle;
        pointer-events: none;
      }

      .region-label {
        font-size: 16px;
        font-weight: 700;
      }

      .subregion-label {
        font-size: 13px;
        font-weight: 600;
      }

      .country-label {
        font-size: 3px;
        font-weight: 500;
      }

      .is-hidden {
        display: none;
      }

      .selected-label {
        font-weight: 600;
        margin: 0;
        padding: 8px 12px;
        background: #eef2ff;
        border-radius: 8px;
        position: absolute;
        left: 12px;
        bottom: 12px;
        width: min(560px, 92vw);
        line-height: 1.4;
      }

      .facts-panel {
        padding: 20px 12px 32px;
        display: grid;
        gap: 12px;
      }

      .facts-panel {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="map-card">
      <div class="map-shell">
        <svg id="world-map" viewBox="0 0 960 520" aria-label="World map"></svg>
        <div id="selected-country" class="selected-label">Selected: None</div>
      </div>
      <section class="facts-panel" aria-label="UN M49 fun social facts">
      </section>
    </div>

    <!--
      CSV lookup for ISO3166-1-numeric -> sub-region metadata.
      Keeping it inline ensures the demo works even when opened directly from disk.
    -->
    <script id="country-codes" type="text/csv">numeric,region_code,region_name,subregion_code,subregion_name
4,142,Asia,34,Southern Asia
248,150,Europe,154,Northern Europe
8,150,Europe,39,Southern Europe
12,2,Africa,15,Northern Africa
16,9,Oceania,61,Polynesia
20,150,Europe,39,Southern Europe
24,2,Africa,202,Sub-Saharan Africa
660,19,Americas,419,Latin America and the Caribbean
10,,,,
28,19,Americas,419,Latin America and the Caribbean
32,19,Americas,419,Latin America and the Caribbean
51,142,Asia,145,Western Asia
533,19,Americas,419,Latin America and the Caribbean
36,9,Oceania,53,Australia and New Zealand
40,150,Europe,155,Western Europe
31,142,Asia,145,Western Asia
44,19,Americas,419,Latin America and the Caribbean
48,142,Asia,145,Western Asia
50,142,Asia,34,Southern Asia
52,19,Americas,419,Latin America and the Caribbean
112,150,Europe,151,Eastern Europe
56,150,Europe,155,Western Europe
84,19,Americas,419,Latin America and the Caribbean
204,2,Africa,202,Sub-Saharan Africa
60,19,Americas,21,Northern America
64,142,Asia,34,Southern Asia
68,19,Americas,419,Latin America and the Caribbean
535,19,Americas,419,Latin America and the Caribbean
70,150,Europe,39,Southern Europe
72,2,Africa,202,Sub-Saharan Africa
74,19,Americas,419,Latin America and the Caribbean
76,19,Americas,419,Latin America and the Caribbean
86,2,Africa,202,Sub-Saharan Africa
92,19,Americas,419,Latin America and the Caribbean
96,142,Asia,35,South-eastern Asia
100,150,Europe,151,Eastern Europe
854,2,Africa,202,Sub-Saharan Africa
108,2,Africa,202,Sub-Saharan Africa
132,2,Africa,202,Sub-Saharan Africa
116,142,Asia,35,South-eastern Asia
120,2,Africa,202,Sub-Saharan Africa
124,19,Americas,21,Northern America
136,19,Americas,419,Latin America and the Caribbean
140,2,Africa,202,Sub-Saharan Africa
148,2,Africa,202,Sub-Saharan Africa
152,19,Americas,419,Latin America and the Caribbean
156,142,Asia,30,Eastern Asia
344,142,Asia,30,Eastern Asia
446,142,Asia,30,Eastern Asia
162,9,Oceania,53,Australia and New Zealand
166,9,Oceania,53,Australia and New Zealand
170,19,Americas,419,Latin America and the Caribbean
174,2,Africa,202,Sub-Saharan Africa
178,2,Africa,202,Sub-Saharan Africa
184,9,Oceania,61,Polynesia
188,19,Americas,419,Latin America and the Caribbean
191,150,Europe,39,Southern Europe
192,19,Americas,419,Latin America and the Caribbean
531,19,Americas,419,Latin America and the Caribbean
196,142,Asia,145,Western Asia
203,150,Europe,151,Eastern Europe
408,142,Asia,30,Eastern Asia
180,2,Africa,202,Sub-Saharan Africa
208,150,Europe,154,Northern Europe
262,2,Africa,202,Sub-Saharan Africa
212,19,Americas,419,Latin America and the Caribbean
214,19,Americas,419,Latin America and the Caribbean
218,19,Americas,419,Latin America and the Caribbean
818,2,Africa,15,Northern Africa
222,19,Americas,419,Latin America and the Caribbean
226,2,Africa,202,Sub-Saharan Africa
232,2,Africa,202,Sub-Saharan Africa
233,150,Europe,154,Northern Europe
748,2,Africa,202,Sub-Saharan Africa
231,2,Africa,202,Sub-Saharan Africa
238,19,Americas,419,Latin America and the Caribbean
234,150,Europe,154,Northern Europe
242,9,Oceania,54,Melanesia
246,150,Europe,154,Northern Europe
250,150,Europe,155,Western Europe
254,19,Americas,419,Latin America and the Caribbean
258,9,Oceania,61,Polynesia
260,2,Africa,202,Sub-Saharan Africa
266,2,Africa,202,Sub-Saharan Africa
270,2,Africa,202,Sub-Saharan Africa
268,142,Asia,145,Western Asia
276,150,Europe,155,Western Europe
288,2,Africa,202,Sub-Saharan Africa
292,150,Europe,39,Southern Europe
300,150,Europe,39,Southern Europe
304,19,Americas,21,Northern America
308,19,Americas,419,Latin America and the Caribbean
312,19,Americas,419,Latin America and the Caribbean
316,9,Oceania,57,Micronesia
320,19,Americas,419,Latin America and the Caribbean
831,150,Europe,154,Northern Europe
324,2,Africa,202,Sub-Saharan Africa
624,2,Africa,202,Sub-Saharan Africa
328,19,Americas,419,Latin America and the Caribbean
332,19,Americas,419,Latin America and the Caribbean
334,9,Oceania,53,Australia and New Zealand
336,150,Europe,39,Southern Europe
340,19,Americas,419,Latin America and the Caribbean
348,150,Europe,151,Eastern Europe
352,150,Europe,154,Northern Europe
356,142,Asia,34,Southern Asia
360,142,Asia,35,South-eastern Asia
364,142,Asia,34,Southern Asia
368,142,Asia,145,Western Asia
372,150,Europe,154,Northern Europe
833,150,Europe,154,Northern Europe
376,142,Asia,145,Western Asia
380,150,Europe,39,Southern Europe
384,2,Africa,202,Sub-Saharan Africa
388,19,Americas,419,Latin America and the Caribbean
392,142,Asia,30,Eastern Asia
832,150,Europe,154,Northern Europe
400,142,Asia,145,Western Asia
398,142,Asia,143,Central Asia
404,2,Africa,202,Sub-Saharan Africa
296,9,Oceania,57,Micronesia
414,142,Asia,145,Western Asia
417,142,Asia,143,Central Asia
418,142,Asia,35,South-eastern Asia
428,150,Europe,154,Northern Europe
422,142,Asia,145,Western Asia
426,2,Africa,202,Sub-Saharan Africa
430,2,Africa,202,Sub-Saharan Africa
434,2,Africa,15,Northern Africa
438,150,Europe,155,Western Europe
440,150,Europe,154,Northern Europe
442,150,Europe,155,Western Europe
450,2,Africa,202,Sub-Saharan Africa
454,2,Africa,202,Sub-Saharan Africa
458,142,Asia,35,South-eastern Asia
462,142,Asia,34,Southern Asia
466,2,Africa,202,Sub-Saharan Africa
470,150,Europe,39,Southern Europe
584,9,Oceania,57,Micronesia
474,19,Americas,419,Latin America and the Caribbean
478,2,Africa,202,Sub-Saharan Africa
480,2,Africa,202,Sub-Saharan Africa
175,2,Africa,202,Sub-Saharan Africa
484,19,Americas,419,Latin America and the Caribbean
583,9,Oceania,57,Micronesia
492,150,Europe,155,Western Europe
496,142,Asia,30,Eastern Asia
499,150,Europe,39,Southern Europe
500,19,Americas,419,Latin America and the Caribbean
504,2,Africa,15,Northern Africa
508,2,Africa,202,Sub-Saharan Africa
104,142,Asia,35,South-eastern Asia
516,2,Africa,202,Sub-Saharan Africa
520,9,Oceania,57,Micronesia
524,142,Asia,34,Southern Asia
528,150,Europe,155,Western Europe
540,9,Oceania,54,Melanesia
554,9,Oceania,53,Australia and New Zealand
558,19,Americas,419,Latin America and the Caribbean
562,2,Africa,202,Sub-Saharan Africa
566,2,Africa,202,Sub-Saharan Africa
570,9,Oceania,61,Polynesia
574,9,Oceania,53,Australia and New Zealand
580,9,Oceania,57,Micronesia
807,150,Europe,39,Southern Europe
578,150,Europe,154,Northern Europe
512,142,Asia,145,Western Asia
586,142,Asia,34,Southern Asia
585,9,Oceania,57,Micronesia
591,19,Americas,419,Latin America and the Caribbean
598,9,Oceania,54,Melanesia
600,19,Americas,419,Latin America and the Caribbean
604,19,Americas,419,Latin America and the Caribbean
608,142,Asia,35,South-eastern Asia
612,9,Oceania,61,Polynesia
616,150,Europe,151,Eastern Europe
620,150,Europe,39,Southern Europe
630,19,Americas,419,Latin America and the Caribbean
634,142,Asia,145,Western Asia
410,142,Asia,30,Eastern Asia
498,150,Europe,151,Eastern Europe
638,2,Africa,202,Sub-Saharan Africa
642,150,Europe,151,Eastern Europe
643,150,Europe,151,Eastern Europe
646,2,Africa,202,Sub-Saharan Africa
652,19,Americas,419,Latin America and the Caribbean
654,2,Africa,202,Sub-Saharan Africa
659,19,Americas,419,Latin America and the Caribbean
662,19,Americas,419,Latin America and the Caribbean
663,19,Americas,419,Latin America and the Caribbean
666,19,Americas,21,Northern America
670,19,Americas,419,Latin America and the Caribbean
882,9,Oceania,61,Polynesia
674,150,Europe,39,Southern Europe
678,2,Africa,202,Sub-Saharan Africa
682,142,Asia,145,Western Asia
686,2,Africa,202,Sub-Saharan Africa
688,150,Europe,39,Southern Europe
690,2,Africa,202,Sub-Saharan Africa
694,2,Africa,202,Sub-Saharan Africa
702,142,Asia,35,South-eastern Asia
534,19,Americas,419,Latin America and the Caribbean
703,150,Europe,151,Eastern Europe
705,150,Europe,39,Southern Europe
90,9,Oceania,54,Melanesia
706,2,Africa,202,Sub-Saharan Africa
710,2,Africa,202,Sub-Saharan Africa
239,19,Americas,419,Latin America and the Caribbean
728,2,Africa,202,Sub-Saharan Africa
724,150,Europe,39,Southern Europe
144,142,Asia,34,Southern Asia
275,142,Asia,145,Western Asia
729,2,Africa,15,Northern Africa
740,19,Americas,419,Latin America and the Caribbean
744,150,Europe,154,Northern Europe
752,150,Europe,154,Northern Europe
756,150,Europe,155,Western Europe
760,142,Asia,145,Western Asia
158,142,Asia,30,Eastern Asia
762,142,Asia,143,Central Asia
764,142,Asia,35,South-eastern Asia
626,142,Asia,35,South-eastern Asia
768,2,Africa,202,Sub-Saharan Africa
772,9,Oceania,61,Polynesia
776,9,Oceania,61,Polynesia
780,19,Americas,419,Latin America and the Caribbean
788,2,Africa,15,Northern Africa
792,142,Asia,145,Western Asia
795,142,Asia,143,Central Asia
796,19,Americas,419,Latin America and the Caribbean
798,9,Oceania,61,Polynesia
800,2,Africa,202,Sub-Saharan Africa
804,150,Europe,151,Eastern Europe
784,142,Asia,145,Western Asia
826,150,Europe,154,Northern Europe
834,2,Africa,202,Sub-Saharan Africa
581,9,Oceania,57,Micronesia
840,19,Americas,21,Northern America
850,19,Americas,419,Latin America and the Caribbean
858,19,Americas,419,Latin America and the Caribbean
860,142,Asia,143,Central Asia
548,9,Oceania,54,Melanesia
862,19,Americas,419,Latin America and the Caribbean
704,142,Asia,35,South-eastern Asia
876,9,Oceania,61,Polynesia
732,2,Africa,15,Northern Africa
887,142,Asia,145,Western Asia
894,2,Africa,202,Sub-Saharan Africa
716,2,Africa,202,Sub-Saharan Africa
    </script>

    <!-- D3 + TopoJSON libraries (CDN, no build tools required) -->
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
    <script>
      // -----------------------------
      // 1) Basic SVG setup
      // -----------------------------
      const svg = d3.select("#world-map");
      const mapGroup = svg.append("g").attr("class", "map-root");
      const width = 960;
      const height = 520;

      // -----------------------------
      // 2) Projection + path generator
      // -----------------------------
      // Equal Earth is a good choice for thematic maps because it preserves
      // area well while keeping continents visually familiar.
      const projection = d3.geoEqualEarth().fitSize([width, height], { type: "Sphere" });
      const path = d3.geoPath(projection);

      // -----------------------------
      // 3) Data loading
      // -----------------------------
      // Natural Earth country geometries come from world-atlas (TopoJSON).
      const worldAtlasUrl =
        "https://cdn.jsdelivr.net/npm/visionscarto-world-atlas@1/world/50m.json";

      // Country code lookup table (CSV embedded in the HTML).
      const countryCodesCsv = d3.select("#country-codes").text().trim();

      function normalizeNumeric(value) {
        const parsed = Number(value);
        return Number.isFinite(parsed) ? String(parsed) : String(value).trim();
      }

      const countryCodesUrl =
        "https://raw.githubusercontent.com/steamsuperstar/Countries-App/main/country-codes.csv";

      function normalizeCountryCodeRow(row) {
        if (row.region_code || row.subregion_code) {
          return row;
        }
        return {
          numeric: row["ISO3166-1-numeric"] ?? row.numeric,
          region_code: row["Region Code"] ?? row.region_code,
          region_name: row["Region Name"] ?? row.region_name,
          subregion_code: row["Sub-region Code"] ?? row.subregion_code,
          subregion_name: row["Sub-region Name"] ?? row.subregion_name,
        };
      }

      function normalizeCountryCodes(rows) {
        return rows.map(normalizeCountryCodeRow);
      }

      async function loadCountryCodes() {
        try {
          const response = await fetch(countryCodesUrl);
          if (response.ok) {
            return normalizeCountryCodes(d3.csvParse(await response.text()));
          }
        } catch (error) {
          // Ignore and attempt local fallback.
        }
        try {
          const response = await fetch("country-codes.csv");
          if (response.ok) {
            return normalizeCountryCodes(d3.csvParse(await response.text()));
          }
        } catch (error) {
          // If the file cannot be loaded (e.g., file:// protocol), fall back to inline CSV.
        }
        return normalizeCountryCodes(d3.csvParse(countryCodesCsv));
      }

      Promise.all([d3.json(worldAtlasUrl), loadCountryCodes()]).then(
        ([topology, countryCodes]) => {
          // Convert TopoJSON to GeoJSON features so D3 can draw each country.
          const countryObjectKey =
            ["countries", "world", "admin", "ne_50m_admin_0_countries"].find(
              (key) => topology.objects[key]
            ) ?? Object.keys(topology.objects)[0];
          const countryObject = topology.objects[countryObjectKey];
          const countries = topojson.feature(topology, countryObject).features;

          // Build a lookup for ISO numeric codes -> sub-region metadata.
          const validRows = countryCodes.filter(
            (row) => row.region_code && row.subregion_code
          );

          const subregionByNumeric = new Map(
            validRows.map((row) => [normalizeNumeric(row.numeric), row])
          );

          // Group the CSV by region/sub-region and build quick lookup helpers.
          const subregionGroups = d3.group(validRows, (row) => row.subregion_code);
          const regionGroups = d3.group(validRows, (row) => row.region_code);
          const allSubregionCodes = new Set(
            validRows.map((row) => normalizeNumeric(row.numeric))
          );

          const otherCountries = countries.filter(
            (feature) => !allSubregionCodes.has(normalizeNumeric(feature.id))
          );

          // Build sub-region metadata including merged geometry and member features.
          function safeMerge(geometries) {
            if (!geometries.length) {
              return null;
            }
            return topojson.merge(topology, geometries);
          }

          const subregions = Array.from(subregionGroups, ([code, rows]) => {
            const name = rows[0]?.subregion_name || "Sub-region";
            const regionCode = rows[0]?.region_code || "";
            const regionName = rows[0]?.region_name || "Region";
            const codes = new Set(rows.map((row) => normalizeNumeric(row.numeric)));
            const features = countries.filter((feature) =>
              codes.has(normalizeNumeric(feature.id))
            );
            const geometries = countryObject.geometries.filter((geometry) =>
              codes.has(normalizeNumeric(geometry.id))
            );

            return {
              code,
              name,
              regionCode,
              regionName,
              codes,
              features,
              geometry: safeMerge(geometries),
            };
          }).filter((subregion) => subregion.geometry && subregion.features.length > 0);

          // Build region metadata including merged geometry and related subregions.
          const regions = Array.from(regionGroups, ([code, rows]) => {
            const name = rows[0]?.region_name || "Region";
            const codes = new Set(rows.map((row) => normalizeNumeric(row.numeric)));
            const geometries = countryObject.geometries.filter((geometry) =>
              codes.has(normalizeNumeric(geometry.id))
            );
            const regionSubregions = subregions.filter(
              (subregion) => String(subregion.regionCode) === String(code)
            );

            return {
              code,
              name,
              codes,
              subregions: regionSubregions,
              geometry: safeMerge(geometries),
            };
          }).filter((region) => region.geometry && region.subregions.length > 0);

          const regionFacts = new Map([
            [
              "Africa",
              {
                code: "002",
                fact:
                  "Africa is home to the youngest population in the world — more than 60% of Africans are under 25, shaping global music, fashion, and digital culture.",
              },
            ],
            [
              "Americas",
              {
                code: "019",
                fact:
                  "The Americas contain every major world religion, yet many of the region’s most influential cultural movements (jazz, hip-hop, salsa) originated locally.",
              },
            ],
            [
              "Asia",
              {
                code: "142",
                fact:
                  "Asia contains more languages than any other region, with over 2,300 living languages spoken across the continent.",
              },
            ],
            [
              "Europe",
              {
                code: "150",
                fact:
                  "Europe has the highest number of international borders per square kilometer, which helps explain its dense mix of languages, cuisines, and identities.",
              },
            ],
            [
              "Oceania",
              {
                code: "009",
                fact:
                  "Oceania’s societies are among the most maritime-oriented cultures on Earth, with navigation traditions that predate modern instruments.",
              },
            ],
            [
              "Antarctica",
              {
                code: "010",
                fact:
                  "Antarctica has no permanent population, yet is governed cooperatively by dozens of countries under international treaties — a rare example of peaceful global governance.",
              },
            ],
          ]);

          const subregionFacts = new Map([
            [
              "Northern Africa",
              {
                code: "015",
                fact:
                  "Arabic, Amazigh (Berber), French, and English influences intersect here, making it one of the world’s most linguistically blended regions.",
              },
            ],
            [
              "Western Africa",
              {
                code: "011",
                fact:
                  "Western Africa is a global music powerhouse, influencing jazz, blues, reggae, and Afrobeat worldwide.",
              },
            ],
            [
              "Middle Africa",
              {
                code: "017",
                fact:
                  "Extended family networks play a central social role, often functioning as economic safety nets where formal systems are limited.",
              },
            ],
            [
              "Eastern Africa",
              {
                code: "014",
                fact:
                  "This region is considered a cradle of humanity and remains one of the world’s most linguistically diverse areas.",
              },
            ],
            [
              "Southern Africa",
              {
                code: "018",
                fact:
                  "Southern Africa has some of the strongest traditions of oral storytelling, where history is preserved through spoken narrative.",
              },
            ],
            [
              "Sub-Saharan Africa",
              {
                code: "202",
                fact:
                  "Social life is deeply community-oriented, with extended families, shared celebrations, and music often playing a central role in everyday connection.",
              },
            ],
            [
              "Northern America",
              {
                code: "021",
                fact:
                  "High levels of immigration have made Northern America one of the most culturally plural regions in the world.",
              },
            ],
            [
              "Central America",
              {
                code: "013",
                fact:
                  "Community festivals blending Indigenous, African, and European traditions are central to social life.",
              },
            ],
            [
              "Latin America and the Caribbean",
              {
                code: "419",
                fact:
                  "Social interaction is often expressive and outward-facing, with strong emphasis on family, public gatherings, music, and shared celebration in daily life.",
              },
            ],
            [
              "Caribbean",
              {
                code: "029",
                fact:
                  "Despite its small land area, the Caribbean has had an outsized influence on global music, food, and sports.",
              },
            ],
            [
              "South America",
              {
                code: "005",
                fact:
                  "South America hosts some of the world’s strongest regional identities, where local culture often matters more than national borders.",
              },
            ],
            [
              "Central Asia",
              {
                code: "143",
                fact:
                  "Hospitality is a deeply rooted social value — guests are traditionally treated as honored visitors, regardless of social status.",
              },
            ],
            [
              "Eastern Asia",
              {
                code: "030",
                fact:
                  "Collective harmony and respect for elders are core social values that strongly influence education and work culture.",
              },
            ],
            [
              "Southern Asia",
              {
                code: "034",
                fact:
                  "This sub-region has some of the largest and most vibrant family networks in the world, often spanning multiple generations under one roof.",
              },
            ],
            [
              "South-eastern Asia",
              {
                code: "035",
                fact:
                  "Markets and street food are central social spaces, acting as daily meeting points for communities.",
              },
            ],
            [
              "Western Asia",
              {
                code: "145",
                fact:
                  "Family, tribe, and community affiliations often shape social identity as strongly as nationality.",
              },
            ],
            [
              "Northern Europe",
              {
                code: "154",
                fact:
                  "High trust in public institutions supports strong social welfare systems and high levels of civic participation.",
              },
            ],
            [
              "Western Europe",
              {
                code: "155",
                fact:
                  "Many modern ideas about democracy, labor rights, and social contracts emerged here and spread globally.",
              },
            ],
            [
              "Southern Europe",
              {
                code: "039",
                fact:
                  "Daily social life is highly public — cafés, plazas, and streets are important community spaces.",
              },
            ],
            [
              "Eastern Europe",
              {
                code: "151",
                fact:
                  "Shared historical experiences have fostered strong traditions of resilience, mutual aid, and cultural preservation.",
              },
            ],
            [
              "Australia and New Zealand",
              {
                code: "053",
                fact:
                  "Indigenous cultures emphasize a deep spiritual connection to land, influencing modern conversations about identity and stewardship.",
              },
            ],
            [
              "Melanesia",
              {
                code: "054",
                fact:
                  "Village-based social organization remains central, with strong obligations to kin and community.",
              },
            ],
            [
              "Micronesia",
              {
                code: "057",
                fact:
                  "Social status is often linked to knowledge of genealogy and navigation rather than wealth.",
              },
            ],
            [
              "Polynesia",
              {
                code: "061",
                fact:
                  "Culture is preserved through performance — dance, chant, and ceremony are essential to social continuity.",
              },
            ],
          ]);

          const countryFacts = new Map([
            [
              "Åland Islands",
              "Social life is shaped by close-knit island communities where Swedish language and maritime traditions remain central to everyday identity.",
            ],
            [
              "Algeria",
              "Social life often centers on family gatherings and long conversations shared over tea or meals.",
            ],
            [
              "Albania",
              "Hospitality is a strong social value, and guests are often treated with exceptional warmth and generosity.",
            ],
            [
              "Angola",
              "Music and dance play a major role in social connection, especially during celebrations and community events.",
            ],
            [
              "Andorra",
              "With a small population, social connections often overlap between work, family, and community life.",
            ],
            [
              "Austria",
              "Cafés serve as important social spaces where conversation, reading, and lingering are part of daily life.",
            ],
            [
              "Benin",
              "Traditions, storytelling, and community rituals remain important ways of passing on social values.",
            ],
            [
              "Belarus",
              "Family and long-standing friendships often form the backbone of social trust and support networks.",
            ],
            [
              "Belgium",
              "Social identity is closely tied to language and region, shaping food, humor, and everyday interactions.",
            ],
            [
              "Botswana",
              "Community cooperation and mutual respect are strongly reflected in everyday social interactions.",
            ],
            [
              "Bosnia and Herzegovina",
              "Coffee culture plays a central social role, with long conversations marking friendship and hospitality.",
            ],
            [
              "British Indian Ocean Territory",
              "With no permanent civilian population, social life is shaped mainly by temporary work and shared routines.",
            ],
            [
              "Bulgaria",
              "Traditions around music, dance, and seasonal festivals remain important ways of strengthening community bonds.",
            ],
            [
              "Burkina Faso",
              "Community festivals and music are central to social life and collective identity.",
            ],
            [
              "Burundi",
              "Social bonds are often reinforced through shared agricultural work and family networks.",
            ],
            [
              "Cabo Verde",
              "Music and migration history strongly shape social identity and everyday conversation.",
            ],
            [
              "Cameroon",
              "Great cultural diversity means social customs vary widely between regions and communities.",
            ],
            [
              "Central African Republic",
              "Community life often centers on extended families and mutual support within local neighborhoods.",
            ],
            [
              "Chad",
              "Social identity is closely tied to ethnic group, language, and local traditions.",
            ],
            [
              "Comoros",
              "Social traditions emphasize family ties, community ceremonies, and shared responsibility.",
            ],
            [
              "Congo",
              "Music and dance play a major role in social connection and community expression.",
            ],
            [
              "Croatia",
              "Social life often revolves around shared meals and time spent outdoors, especially along the coast.",
            ],
            [
              "Czechia",
              "Pubs and local gathering spots are key social hubs where community life unfolds informally.",
            ],
            [
              "Czech Republic",
              "Pubs and local gathering spots are key social hubs where community life unfolds informally.",
            ],
            [
              "Democratic Republic of the Congo",
              "Despite its vast size, everyday social life is often rooted in very local family and neighborhood networks.",
            ],
            [
              "Denmark",
              "Everyday social life emphasizes comfort and togetherness, often summed up by the idea of hygge.",
            ],
            [
              "Djibouti",
              "Social interaction reflects a blend of African, Arab, and maritime influences.",
            ],
            [
              "Egypt",
              "Family life and hospitality remain central to everyday social structure.",
            ],
            [
              "Equatorial Guinea",
              "Social life often blends local traditions with influences from Spanish culture.",
            ],
            [
              "Eritrea",
              "Strong community bonds are often built through shared history and collective responsibility.",
            ],
            [
              "Estonia",
              "Digital life blends smoothly with social life, while shared traditions still anchor community identity.",
            ],
            [
              "Eswatini",
              "Traditional ceremonies and respect for elders play an important social role.",
            ],
            [
              "Ethiopia",
              "Coffee ceremonies are a key social ritual that brings families and neighbors together.",
            ],
            [
              "Faroe Islands",
              "Small, remote communities place strong emphasis on mutual support and shared responsibility.",
            ],
            [
              "Finland",
              "Quiet respect for personal space coexists with deep trust in close social circles.",
            ],
            [
              "France",
              "Meals are often social rituals, where time spent together matters as much as the food itself.",
            ],
            [
              "French Southern Territories",
              "Social interaction is limited to small, temporary research communities.",
            ],
            [
              "Gabon",
              "Social life often balances modern urban living with strong family traditions.",
            ],
            [
              "Gambia",
              "Close-knit communities and frequent neighborly interaction shape daily social life.",
            ],
            [
              "Germany",
              "Clubs and associations play a major role in social life, bringing people together around shared interests.",
            ],
            [
              "Gibraltar",
              "Daily life reflects a blend of cultures, where social interactions easily cross linguistic and national lines.",
            ],
            [
              "Ghana",
              "Social identity is often reinforced through festivals, storytelling, and respect for elders.",
            ],
            [
              "Greece",
              "Conversation, food, and public spaces form the heart of social life and community connection.",
            ],
            [
              "Guernsey",
              "Island life encourages close social ties, where community events and shared history matter greatly.",
            ],
            [
              "Guinea",
              "Music and oral tradition play an important role in community life.",
            ],
            [
              "Guinea-Bissau",
              "Village life and extended family networks remain central to social organization.",
            ],
            [
              "Holy See",
              "Social life centers on religious tradition and international exchange rather than a resident civilian population.",
            ],
            [
              "Hungary",
              "Family gatherings and shared meals are important anchors of social life.",
            ],
            [
              "Ivory Coast",
              "Social life reflects a mix of ethnic traditions and modern urban culture.",
            ],
            [
              "Iceland",
              "A small population fosters overlapping social networks where people are often connected in multiple ways.",
            ],
            [
              "Ireland",
              "Storytelling, humor, and conversation play a central role in everyday social interaction.",
            ],
            [
              "Isle of Man",
              "Strong local identity is reinforced through community traditions and shared island history.",
            ],
            [
              "Italy",
              "Social life often unfolds in public spaces, where food, family, and conversation come together daily.",
            ],
            [
              "Kenya",
              "Social connections often form through family, community groups, and shared public spaces.",
            ],
            [
              "Jersey",
              "Community life balances local traditions with influences from both Britain and France.",
            ],
            [
              "Latvia",
              "Folk traditions and seasonal celebrations remain important expressions of social identity.",
            ],
            [
              "Lesotho",
              "Strong community ties are shaped by rural life and shared cultural traditions.",
            ],
            [
              "Liberia",
              "Storytelling and shared history are important parts of social interaction.",
            ],
            [
              "Libya",
              "Family and tribal connections strongly influence social life.",
            ],
            [
              "Liechtenstein",
              "With a small population, social and professional circles often overlap closely.",
            ],
            [
              "Lithuania",
              "Singing and cultural festivals play a meaningful role in maintaining community bonds.",
            ],
            [
              "Madagascar",
              "Social customs emphasize respect for ancestors and community cooperation.",
            ],
            [
              "Luxembourg",
              "Daily social life is highly multilingual, reflecting the country’s international character.",
            ],
            [
              "Malawi",
              "Friendliness and informal social interaction are often highlighted in daily life.",
            ],
            [
              "Malta",
              "Community life is shaped by neighborhood ties, religious festivals, and shared outdoor spaces.",
            ],
            [
              "Mali",
              "Music and oral history play a central role in maintaining social bonds.",
            ],
            [
              "Mauritania",
              "Social life reflects a blend of desert, coastal, and nomadic traditions.",
            ],
            [
              "Mauritius",
              "A multicultural society where social life blends many cuisines, languages, and traditions.",
            ],
            [
              "Mayotte",
              "Community life reflects a mix of African, Arab, and French cultural influences.",
            ],
            [
              "Monaco",
              "Social life blends local community with an international population drawn by work and events.",
            ],
            [
              "Montenegro",
              "Hospitality and strong personal relationships are central to everyday social interactions.",
            ],
            [
              "Morocco",
              "Social life often centers on hospitality, shared meals, and lively marketplaces.",
            ],
            [
              "Mozambique",
              "Music, dance, and coastal traditions shape everyday social interaction.",
            ],
            [
              "Namibia",
              "Social connections often form around community gatherings and shared outdoor life.",
            ],
            [
              "Netherlands",
              "Direct communication and informal social norms strongly shape everyday interaction.",
            ],
            [
              "Niger",
              "Social identity is closely linked to family, local customs, and shared community traditions.",
            ],
            [
              "Nigeria",
              "With immense cultural diversity, social life varies widely but often centers on community and celebration.",
            ],
            [
              "North Macedonia",
              "Music, food, and family gatherings remain key ways of maintaining social ties.",
            ],
            [
              "Norway",
              "Equality and trust strongly influence social interaction, even in informal settings.",
            ],
            [
              "Réunion",
              "Social life blends African, Asian, and European influences into a distinctive island culture.",
            ],
            [
              "Poland",
              "Family celebrations and shared traditions play a major role in social life.",
            ],
            [
              "Portugal",
              "Social life often centers on long meals and relaxed conversation with family and friends.",
            ],
            [
              "Republic of Moldova",
              "Community connections are often strengthened through hospitality, shared food, and local customs.",
            ],
            [
              "Moldova",
              "Community connections are often strengthened through shared food, hospitality, and local customs.",
            ],
            [
              "Romania",
              "Social traditions often blend rural heritage with modern urban life.",
            ],
            [
              "Russian Federation",
              "Social circles are often built on deep, long-term relationships rather than casual acquaintance.",
            ],
            [
              "Russia",
              "Social circles are often built on deep, long-term relationships rather than casual acquaintance.",
            ],
            [
              "Rwanda",
              "Community cooperation and shared responsibility are emphasized in social life.",
            ],
            [
              "Saint Helena",
              "Isolation has fostered a close-knit community with strong shared identity.",
            ],
            [
              "San Marino",
              "A strong sense of shared history helps maintain close community bonds.",
            ],
            [
              "Sao Tome and Principe",
              "Small island communities emphasize strong social ties and shared traditions.",
            ],
            [
              "Serbia",
              "Cafés and long conversations play a central role in social interaction.",
            ],
            [
              "Senegal",
              "Social life is strongly shaped by hospitality, music, and community gatherings.",
            ],
            [
              "Seychelles",
              "Social interaction reflects a relaxed island lifestyle and multicultural heritage.",
            ],
            [
              "Sierra Leone",
              "Community resilience and mutual support play a key role in social life.",
            ],
            [
              "Slovakia",
              "Social life often centers on family gatherings and shared outdoor traditions.",
            ],
            [
              "Slovenia",
              "Community identity is shaped by a strong connection to local landscapes and traditions.",
            ],
            [
              "Somalia",
              "Strong clan and family ties shape social structure and daily interaction.",
            ],
            [
              "Spain",
              "Late meals and lively public spaces are key features of everyday social life.",
            ],
            [
              "South Africa",
              "Social life reflects remarkable cultural diversity and strong local community identities.",
            ],
            [
              "South Sudan",
              "Social bonds are often rooted in kinship and shared community traditions.",
            ],
            [
              "Svalbard and Jan Mayen Islands",
              "Extreme environment fosters cooperation and close social ties among a very small population.",
            ],
            [
              "Sudan",
              "Social interaction often emphasizes hospitality and extended family networks.",
            ],
            [
              "Sweden",
              "Social norms emphasize balance, consensus, and respect for personal space.",
            ],
            [
              "Switzerland",
              "Community life often reflects strong local identity tied to language and region.",
            ],
            [
              "Togo",
              "Community festivals and traditional music help maintain social cohesion.",
            ],
            [
              "Tunisia",
              "Social life blends Mediterranean influences with strong local traditions.",
            ],
            [
              "Uganda",
              "Social life is often lively and communal, with strong emphasis on family and neighbors.",
            ],
            [
              "Ukraine",
              "Social bonds are often reinforced through shared traditions, music, and strong community resilience.",
            ],
            [
              "United Kingdom",
              "Social life reflects a mix of long-standing traditions and diverse regional identities.",
            ],
            [
              "United Republic of Tanzania",
              "Shared language and community traditions help connect diverse social groups.",
            ],
            [
              "Western Sahara",
              "Social life is shaped by nomadic heritage and strong communal bonds.",
            ],
            [
              "Zambia",
              "Social interaction often emphasizes cooperation and respect within extended families.",
            ],
            [
              "Zimbabwe",
              "Storytelling, music, and shared history play important roles in social life.",
            ],
            [
              "Anguilla",
              "Social life is relaxed and community-oriented, with music and beach gatherings shaping everyday connection.",
            ],
            [
              "Antigua and Barbuda",
              "Festivals and sailing traditions play a central role in social life and national identity.",
            ],
            [
              "Argentina",
              "Social life often revolves around shared meals, long conversations, and a strong café culture.",
            ],
            [
              "Aruba",
              "A multilingual society where social life blends island traditions with global influences.",
            ],
            [
              "Bahamas",
              "Social life is shaped by island communities where music, storytelling, and shared celebrations bring people together.",
            ],
            [
              "Barbados",
              "Social life combines strong community ties with lively public festivals and music.",
            ],
            [
              "Belize",
              "A mix of cultures shapes social life, where language, food, and music vary by community.",
            ],
            [
              "Bermuda",
              "Small-island living fosters close social networks and strong local traditions.",
            ],
            [
              "Bolivia (Plurinational State of)",
              "Social life is strongly shaped by Indigenous traditions, local markets, and community festivals that bring people together.",
            ],
            [
              "Bonaire, Sint Eustatius and Saba",
              "Social life is shaped by small-island communities with strong local ties and shared customs.",
            ],
            [
              "Bouvet Island",
              "With no permanent residents, social life exists only through temporary scientific visits.",
            ],
            [
              "Brazil",
              "Music, sport, and celebration play a major role in bringing people together socially.",
            ],
            [
              "British Virgin Islands",
              "Island life encourages close social bonds centered on community events and shared spaces.",
            ],
            [
              "Canada",
              "Social life balances individual space with strong community participation and volunteerism.",
            ],
            [
              "Cayman Islands",
              "Social interaction reflects a mix of local island culture and international influences.",
            ],
            [
              "Chile",
              "Family gatherings and shared meals are central to everyday social life.",
            ],
            [
              "Colombia",
              "Social life is lively and expressive, with music and conversation at its heart.",
            ],
            [
              "Costa Rica",
              "A relaxed approach to life shapes social interaction and community values.",
            ],
            [
              "Cuba",
              "Music, dance, and public conversation are key elements of social connection.",
            ],
            [
              "Curaçao",
              "Multilingual social life reflects a blend of Caribbean, European, and Latin influences.",
            ],
            [
              "Dominica",
              "Strong community ties are shaped by village life and shared cultural traditions.",
            ],
            [
              "Dominican Republic",
              "Music, dance, and family gatherings are central to everyday social interaction.",
            ],
            [
              "Ecuador",
              "Social customs often blend Indigenous heritage with modern urban life.",
            ],
            [
              "El Salvador",
              "Family and neighborhood networks form the core of social life.",
            ],
            [
              "Falkland Islands",
              "A small population fosters close-knit social connections where community events and shared routines matter greatly.",
            ],
            [
              "French Guiana",
              "Social life reflects a diverse mix of cultures shaped by migration and local traditions.",
            ],
            [
              "Greenland",
              "Community life emphasizes cooperation and strong ties in a challenging environment.",
            ],
            [
              "Grenada",
              "Festivals and shared meals help maintain strong community bonds.",
            ],
            [
              "Guadeloupe",
              "Social life blends Caribbean traditions with French cultural influences.",
            ],
            [
              "Guatemala",
              "Social identity is often shaped by Indigenous traditions and local community life.",
            ],
            [
              "Guyana",
              "A multicultural society where social life reflects many cultural traditions living side by side.",
            ],
            [
              "Haiti",
              "Music, religion, and community resilience play central roles in social life.",
            ],
            [
              "Honduras",
              "Family and local community ties strongly influence social interaction.",
            ],
            [
              "Jamaica",
              "Music and expressive language are powerful forces in everyday social life.",
            ],
            [
              "Martinique",
              "Social life reflects a blend of Caribbean traditions and French cultural life.",
            ],
            [
              "Mexico",
              "Social life centers on family, festivals, and shared public celebrations.",
            ],
            [
              "Montserrat",
              "A small population encourages strong community bonds and shared identity.",
            ],
            [
              "Nicaragua",
              "Community life often revolves around family, festivals, and shared traditions.",
            ],
            [
              "Panama",
              "Social life reflects its role as a crossroads of cultures and trade.",
            ],
            [
              "Paraguay",
              "Bilingualism and strong family networks shape everyday social interaction.",
            ],
            [
              "Peru",
              "Social customs often blend ancient traditions with modern urban culture.",
            ],
            [
              "Puerto Rico",
              "Music, family gatherings, and neighborhood life are central to social identity.",
            ],
            [
              "Saint Barthélemy",
              "Social life mixes small-island community with an international atmosphere.",
            ],
            [
              "Saint Kitts and Nevis",
              "Close-knit communities emphasize shared celebrations and island traditions.",
            ],
            [
              "Saint Lucia",
              "Social life is shaped by music, festivals, and strong neighborhood ties.",
            ],
            [
              "Saint Martin (French Part)",
              "Daily social life crosses cultures and borders in a shared island community.",
            ],
            [
              "Saint Pierre and Miquelon",
              "A small population maintains close social bonds rooted in shared heritage.",
            ],
            [
              "Saint Vincent and the Grenadines",
              "Community life is closely tied to island traditions and shared celebrations.",
            ],
            [
              "Sint Maarten (Dutch part)",
              "Social interaction reflects a blend of Caribbean culture and international tourism.",
            ],
            [
              "South Georgia and the South Sandwich Islands",
              "With no permanent residents, social life exists only within small, temporary research and support teams who rely on close cooperation.",
            ],
            [
              "Suriname",
              "A highly multicultural society where social life blends many languages and traditions.",
            ],
            [
              "Trinidad and Tobago",
              "Carnival culture highlights creativity, music, and social expression.",
            ],
            [
              "Turks and Caicos Islands",
              "Small-island communities foster close social ties and shared public life.",
            ],
            [
              "United States of America",
              "Social life varies widely but often centers on local communities and shared interests.",
            ],
            [
              "United States Virgin Islands",
              "Social life blends Caribbean traditions with American cultural influences.",
            ],
            [
              "Uruguay",
              "Social interaction often revolves around shared meals, conversation, and community spaces.",
            ],
            [
              "Venezuela (Bolivarian Republic of)",
              "Music, humor, and strong personal relationships play a central role in everyday social interaction.",
            ],
            [
              "Afghanistan",
              "Hospitality is a deeply rooted social value, where welcoming guests is considered a point of personal and family honor.",
            ],
            [
              "Armenia",
              "Strong family ties and shared meals play a central role in social life and cultural continuity.",
            ],
            [
              "Azerbaijan",
              "Social gatherings often revolve around food, music, and long conversations with family and friends.",
            ],
            [
              "Bahrain",
              "Social life blends traditional hospitality with a cosmopolitan, urban lifestyle.",
            ],
            [
              "Bangladesh",
              "Community life is closely connected to family networks and shared neighborhood interactions.",
            ],
            [
              "Bhutan",
              "Social values emphasize community well-being, balance, and mutual respect.",
            ],
            [
              "Brunei Darussalam",
              "Social life is shaped by close family ties and strong community traditions.",
            ],
            [
              "Cambodia",
              "Family gatherings, religious festivals, and shared meals anchor everyday social life.",
            ],
            [
              "China",
              "Social relationships often emphasize respect, hierarchy, and long-term personal connections.",
            ],
            [
              "China, Hong Kong Special Administrative Region",
              "Fast-paced urban life blends with strong social traditions centered on food and family.",
            ],
            [
              "China, Macao Special Administrative Region",
              "Social life reflects a unique mix of Chinese traditions and Portuguese heritage.",
            ],
            [
              "Cyprus",
              "Social interaction often centers on extended family gatherings and shared meals.",
            ],
            [
              "Democratic People's Republic of Korea",
              "Social life is highly structured, with community activities closely tied to collective routines.",
            ],
            [
              "Georgia",
              "Hospitality and long, shared feasts are central expressions of social connection.",
            ],
            [
              "India",
              "Social life is shaped by family, festivals, and everyday interactions across diverse communities.",
            ],
            [
              "Indonesia",
              "Community cooperation and social harmony are emphasized in daily life across its many cultures.",
            ],
            [
              "Iran (Islamic Republic of)",
              "Social gatherings often revolve around poetry, conversation, and shared meals.",
            ],
            [
              "Iraq",
              "Family and extended kin networks play a strong role in social support and identity.",
            ],
            [
              "Israel",
              "Social life often centers on family meals, lively discussion, and community traditions.",
            ],
            [
              "Japan",
              "Social interaction values harmony and courtesy, shaping everyday behavior and etiquette.",
            ],
            [
              "Jordan",
              "Hospitality and generosity toward guests are central social values.",
            ],
            [
              "Kazakhstan",
              "Social traditions reflect nomadic heritage, emphasizing hospitality and respect for elders.",
            ],
            [
              "Kuwait",
              "Social life blends strong family connections with modern urban culture.",
            ],
            [
              "Kyrgyzstan",
              "Community life often reflects nomadic traditions and close family ties.",
            ],
            [
              "Lao People's Democratic Republic",
              "Social life is calm and community-oriented, with strong respect for tradition and shared routines.",
            ],
            [
              "Lebanon",
              "Food, conversation, and social gatherings play a central role in everyday life.",
            ],
            [
              "Malaysia",
              "Social life reflects a multicultural society where different traditions coexist daily.",
            ],
            [
              "Maldives",
              "Island communities emphasize close social ties and shared daily routines.",
            ],
            [
              "Mongolia",
              "Hospitality and openness remain key social values rooted in nomadic culture.",
            ],
            [
              "Myanmar",
              "Community life often centers on family, religious practice, and shared traditions.",
            ],
            [
              "Nepal",
              "Social life blends diverse cultures with strong community and family connections.",
            ],
            [
              "Oman",
              "Politeness and hospitality strongly shape social interaction.",
            ],
            [
              "Pakistan",
              "Family networks and hospitality are central to social life.",
            ],
            [
              "Philippines",
              "Social life is highly family-centered, expressive, and often shaped by music and shared gatherings.",
            ],
            [
              "Qatar",
              "Social life blends traditional customs with a highly international population.",
            ],
            [
              "Republic of Korea",
              "Social interaction emphasizes group harmony, shared meals, and respect for hierarchy.",
            ],
            [
              "Saudi Arabia",
              "Hospitality and family gatherings play an important role in social life.",
            ],
            [
              "Singapore",
              "Social life reflects a highly multicultural society connected through food and shared spaces.",
            ],
            [
              "Sri Lanka",
              "Social life often revolves around family, festivals, and shared meals.",
            ],
            [
              "State of Palestine",
              "Strong family ties and community solidarity play a central role in social life.",
            ],
            [
              "Syrian Arab Republic",
              "Social life traditionally centers on family, hospitality, and close community bonds.",
            ],
            [
              "Taiwan",
              "Social life blends traditional customs with a vibrant modern urban culture.",
            ],
            [
              "Tajikistan",
              "Family and village networks form the core of social life.",
            ],
            [
              "Thailand",
              "Everyday social interaction emphasizes politeness, friendliness, and shared enjoyment.",
            ],
            [
              "Timor-Leste",
              "Community life is closely tied to family, tradition, and shared history.",
            ],
            [
              "Turkey",
              "Social life often centers on hospitality, tea, and lively conversation.",
            ],
            [
              "Turkmenistan",
              "Social traditions emphasize respect for elders and strong family bonds.",
            ],
            [
              "United Arab Emirates",
              "Social life blends traditional hospitality with a highly international population.",
            ],
            [
              "Uzbekistan",
              "Hospitality and shared meals remain key expressions of social connection.",
            ],
            [
              "Viet Nam",
              "Social life strongly centers on family, neighborhood ties, and shared meals.",
            ],
            [
              "Yemen",
              "Social life traditionally emphasizes hospitality, family, and community solidarity.",
            ],
            [
              "American Samoa",
              "Social life is strongly family-centered, with communal responsibility and respect for elders shaping daily interaction.",
            ],
            [
              "Australia",
              "Informal social norms and shared outdoor activities play a big role in everyday community life.",
            ],
            [
              "Christmas Island",
              "A small population creates close social ties influenced by a mix of Asian and Western traditions.",
            ],
            [
              "Cocos (Keeling) Islands",
              "Community life is shaped by strong family networks and a shared island identity.",
            ],
            [
              "Cook Islands",
              "Social life is centered on extended family networks, where shared meals, music, and community celebrations strengthen everyday bonds.",
            ],
            [
              "Fiji",
              "Communal living and hospitality are central, with social life often organized around village life.",
            ],
            [
              "French Polynesia",
              "Social life blends Polynesian traditions with a relaxed island rhythm and shared public spaces.",
            ],
            [
              "Guam",
              "Family and community ties are central, reflecting both Indigenous traditions and modern influences.",
            ],
            [
              "Heard Island and McDonald Islands",
              "With no permanent residents, social life exists only through temporary scientific expeditions.",
            ],
            [
              "Kiribati",
              "Strong community bonds are shaped by island life and shared responsibility for one another.",
            ],
            [
              "Marshall Islands",
              "Social identity is closely tied to family, ocean life, and traditional knowledge passed between generations.",
            ],
            [
              "Micronesia (Federated States of)",
              "Village life and extended family networks play a key role in social organization.",
            ],
            [
              "Nauru",
              "A very small population creates overlapping social circles and strong communal ties.",
            ],
            [
              "New Caledonia",
              "Social life reflects a blend of Indigenous Kanak traditions and multicultural influences.",
            ],
            [
              "New Zealand",
              "Social values emphasize fairness, community participation, and connection to the natural environment.",
            ],
            [
              "Niue",
              "A very small population fosters close social ties both on the island and across a wide diaspora abroad.",
            ],
            [
              "Norfolk Island",
              "A shared history and small population foster a strong sense of community identity.",
            ],
            [
              "Northern Mariana Islands",
              "Social life blends island traditions with influences from Asia and the United States.",
            ],
            [
              "Palau",
              "Community cooperation and respect for tradition strongly shape social life.",
            ],
            [
              "Papua New Guinea",
              "Social life is deeply local, with strong ties to clan, language group, and place.",
            ],
            [
              "Pitcairn",
              "One of the world’s smallest communities relies on close cooperation and shared responsibility.",
            ],
            [
              "Samoa",
              "Social life is organized around extended families and communal decision-making.",
            ],
            [
              "Solomon Islands",
              "Community life centers on village cooperation, shared traditions, and local leadership.",
            ],
            [
              "Tokelau",
              "Extremely small communities emphasize collective responsibility and shared daily routines.",
            ],
            [
              "Tonga",
              "Social life strongly reflects respect for family hierarchy and community obligations.",
            ],
            [
              "Tuvalu",
              "Close social ties and cooperation are essential in everyday island life.",
            ],
            [
              "United States Minor Outlying Islands",
              "With no permanent population, social life is limited to temporary scientific or military presence.",
            ],
            [
              "Vanuatu",
              "Community traditions and local customs remain central to social identity.",
            ],
            [
              "Wallis and Futuna Islands",
              "Social life is shaped by strong family ties and Polynesian cultural traditions.",
            ],
            [
              "Antarctica",
              "With no permanent residents, social life exists only in temporary research stations where international cooperation is essential.",
            ],
            [
              "Bahamas (the)",
              "Social life is shaped by close island communities where music, storytelling, and shared celebrations are central.",
            ],
            [
              "Central African Republic (the)",
              "Everyday social life often revolves around extended families and strong local community support.",
            ],
            [
              "Comoros (the)",
              "Social traditions emphasize family ties, community ceremonies, and shared responsibility.",
            ],
            [
              "Congo (the)",
              "Music and dance are important social languages that bring communities together.",
            ],
            [
              "Cook Islands (the)",
              "Social life is centered on extended family networks, where shared meals, music, and community celebrations strengthen everyday bonds.",
            ],
            [
              "Democratic People's Republic of Korea (the)",
              "Social life is highly structured, with community activities closely tied to collective routines.",
            ],
            [
              "Democratic Republic of the Congo (the)",
              "Despite its vast size, social life is often rooted in very local family and neighborhood networks.",
            ],
            [
              "Dominican Republic (the)",
              "Music, dance, and family gatherings are central to everyday social interaction.",
            ],
            [
              "Gambia (the)",
              "Close-knit communities and frequent neighborly interaction shape daily social life.",
            ],
            [
              "Holy See (the)",
              "Social interaction revolves around religious tradition and international exchange rather than a typical residential community.",
            ],
            [
              "Lao People's Democratic Republic (the)",
              "Social life is calm and community-oriented, with strong respect for tradition and shared routines.",
            ],
            [
              "Marshall Islands (the)",
              "Social identity is closely tied to family, ocean life, and traditional knowledge passed between generations.",
            ],
            [
              "Netherlands (the)",
              "Direct communication and informal social norms strongly shape everyday interaction.",
            ],
            [
              "Niger (the)",
              "Social identity is closely linked to family, local customs, and shared community traditions.",
            ],
            [
              "Philippines (the)",
              "Social life is highly family-centered, expressive, and often shaped by music and shared gatherings.",
            ],
            [
              "Republic of Korea (the)",
              "Social interaction emphasizes group harmony, shared meals, and respect for hierarchy.",
            ],
            [
              "Republic of Moldova (the)",
              "Community connections are often strengthened through hospitality, shared food, and local customs.",
            ],
            [
              "Russian Federation (the)",
              "Social circles are often built on deep, long-term relationships rather than casual acquaintance.",
            ],
            [
              "State of Palestine (the)",
              "Strong family connections and community solidarity play a central role in everyday social life.",
            ],
            [
              "Sudan (the)",
              "Social interaction often emphasizes hospitality and extended family networks.",
            ],
            [
              "Syrian Arab Republic (the)",
              "Social life traditionally centers on family, hospitality, and close community bonds.",
            ],
            [
              "United Arab Emirates (the)",
              "Social life blends traditional hospitality with a highly international population.",
            ],
            [
              "United Kingdom of Great Britain and Northern Ireland (the)",
              "Social life reflects a mix of long-standing traditions and diverse regional identities.",
            ],
            [
              "United Republic of Tanzania (the)",
              "Shared language and community traditions help connect diverse social groups.",
            ],
            [
              "United States of America (the)",
              "Social life varies widely but often centers on local communities and shared interests.",
            ],
          ]);
          const countryAliases = new Map([
            ["S. Geo. and the Is.", "South Georgia and the South Sandwich Islands"],
            ["Falkland Is.", "Falkland Islands"],
            ["Bolivia", "Bolivia (Plurinational State of)"],
            ["Venezuela", "Venezuela (Bolivarian Republic of)"],
          ]);

          // -----------------------------
          // 4) Draw layers
          // -----------------------------
          const countriesGroup = mapGroup.append("g").attr("class", "countries-layer");
          const regionGroup = mapGroup.append("g").attr("class", "regions-layer");
          const subregionGroup = mapGroup
            .append("g")
            .attr("class", "subregions-layer is-hidden");
          const subregionCountriesGroup = mapGroup
            .append("g")
            .attr("class", "subregion-countries-layer is-hidden");
          const regionLabelsGroup = mapGroup
            .append("g")
            .attr("class", "region-labels-layer");
          const subregionLabelsGroup = mapGroup
            .append("g")
            .attr("class", "subregion-labels-layer is-hidden");
          const countryLabelsGroup = mapGroup
            .append("g")
            .attr("class", "country-labels-layer is-hidden");
          const zoom = d3
            .zoom()
            .scaleExtent([1, 8])
            .on("zoom", (event) => {
              mapGroup.attr("transform", event.transform);
            });

          svg.call(zoom);
          svg.on("click", (event) => {
            if (event.defaultPrevented) return;
            const target = event.target;
            const isShapeClick =
              target.closest(".region") ||
              target.closest(".subregion") ||
              target.closest(".country");
            if (!isShapeClick) {
              clearSelections();
              setSelectionDisplay({ label: "None" });
            }
          });

          function zoomToGeometry(geometry, options = {}) {
            const [[x0, y0], [x1, y1]] = path.bounds(geometry);
            const dx = x1 - x0;
            const dy = y1 - y0;
            const fallbackCenter = [(x0 + x1) / 2, (y0 + y1) / 2];
            const [x, y] = options.center ?? fallbackCenter;
            const padding = options.padding ?? 0.9;
            const maxScale = options.maxScale ?? 8;
            const scale = Math.min(maxScale, padding / Math.max(dx / width, dy / height));
            const xOffset = options.xOffset ?? 0;
            const yOffset = options.yOffset ?? 0;
            const translate = [
              width / 2 - scale * x + xOffset,
              height / 2 - scale * y + yOffset,
            ];
            svg
              .transition()
              .duration(options.duration ?? 450)
              .call(
                zoom.transform,
                d3.zoomIdentity.translate(translate[0], translate[1]).scale(scale)
              );
          }

          function resetZoom() {
            svg.transition().duration(450).call(zoom.transform, d3.zoomIdentity);
          }

          function drawCountries() {
            const baseCountries = otherCountries.length ? otherCountries : countries;
            countriesGroup
              .selectAll("path")
              .data(baseCountries)
              .join("path")
              .attr("class", "country")
              .attr("d", path)
              .on("click", function (event, d) {
                clearSelections();
                d3.select(this).classed("is-selected", true);
                const countryName = d.properties.name || "Unknown country";
                setSelectionDisplay({
                  label: countryName,
                  fact: getCountryFact(countryName),
                });
              });
          }

          function drawRegions() {
            const hasRegions = regions.length > 0;
            regionGroup.classed("is-hidden", !hasRegions);
            if (hasRegions) {
              regionGroup.raise();
              countriesGroup.lower();
              countriesGroup.classed("is-hidden", true);
              regionLabelsGroup.raise();
            } else {
              countriesGroup.classed("is-hidden", false);
            }

            regionGroup
              .selectAll("path")
              .data(regions)
              .join("path")
              .attr("class", "region")
              .attr("d", (d) => path(d.geometry))
              .on("click", function (event, d) {
                event.stopPropagation();
                clearSelections();
                d3.select(this).classed("is-selected", true);
                drawSubregions(d);
                subregionGroup.classed("is-hidden", false);
                subregionGroup.raise();
                regionGroup.lower();
                subregionCountriesGroup.classed("is-hidden", true);
                regionLabelsGroup.classed("is-hidden", true);
                subregionLabelsGroup.classed("is-hidden", false);
                countryLabelsGroup.classed("is-hidden", true);
                subregionLabelsGroup.raise();
                if (d.name !== "Oceania") {
                  const useEuropeZoom = d.name === "Europe";
                  zoomToGeometry(d.geometry, {
                    duration: 450,
                    padding: useEuropeZoom ? 1.15 : 0.9,
                    maxScale: useEuropeZoom ? 9 : 8,
                  });
                }
                const selectionLabel = `${d.name} (region)`;
                setSelectionDisplay({
                  label: selectionLabel,
                  fact: getSelectionFact({ name: d.name, kind: "region" }),
                });
              });

            regionLabelsGroup
              .classed("is-hidden", !hasRegions)
              .selectAll("text")
              .data(regions, (d) => d.code)
              .join("text")
              .attr("class", "label region-label")
              .attr("x", (d) => path.centroid(d.geometry)[0])
              .attr("y", (d) => path.centroid(d.geometry)[1])
              .text((d) => d.name);
          }

          // Draw each sub-region for the selected region.
          function drawSubregions(region) {
            subregionGroup
              .selectAll("path")
              .data(region.subregions, (d) => d.code)
              .join("path")
              .attr("class", "subregion")
              .attr("d", (d) => path(d.geometry))
              .on("click", function (event, d) {
                event.stopPropagation();
                clearSelections({ keepRegion: true, keepSubregions: true });
                d3.select(this).classed("is-selected", true);
                drawSubregionCountries(d);
                subregionCountriesGroup.classed("is-hidden", false);
                subregionCountriesGroup.raise();
                subregionLabelsGroup.classed("is-hidden", true);
                countryLabelsGroup.classed("is-hidden", false);
                countryLabelsGroup.raise();
                const deepZoomSubregions = new Set(["151", "21", "54"]);
                const isDeepZoom = deepZoomSubregions.has(String(d.code));
                const namedZoomTargets = new Map([
                  ["Melanesia", "Vanuatu"],
                  ["Micronesia", "Micronesia (Federated States of)"],
                  ["Australia and New Zealand", "Australia"],
                  ["Western Europe", "Luxembourg"],
                ]);
                const targetName = namedZoomTargets.get(d.name);
                const targetFeature = targetName
                  ? d.features.find((feature) => feature.properties.name === targetName)
                  : null;
                const useDeeperZoom = d.name === "Micronesia";
                const useShallowerZoom = d.name === "Melanesia";
                const useWesternEuropeZoom = d.name === "Western Europe";
                const useNorthernAmericaZoom = d.name === "Northern America";
                const useEasternEuropeZoom = d.name === "Eastern Europe";
                const useMicronesiaZoom = d.name === "Micronesia";
                const micronesiaClusterNames = new Set([
                  "Micronesia (Federated States of)",
                  "Marshall Islands",
                  "Palau",
                  "Nauru",
                  "Guam",
                  "Northern Mariana Islands",
                ]);
                const micronesiaClusterFeatures = d.features.filter((feature) =>
                  micronesiaClusterNames.has(feature.properties.name)
                );
                const micronesiaFocusFeatures =
                  micronesiaClusterFeatures.length > 0
                    ? micronesiaClusterFeatures
                    : d.features;
                const micronesiaClusterCenter = useMicronesiaZoom
                  ? path.centroid({
                      type: "FeatureCollection",
                      features: micronesiaFocusFeatures,
                    })
                  : null;
                const zoomTarget = useMicronesiaZoom ? d.geometry : targetFeature || d.geometry;
                const micronesiaNudge = [24, -12];
                zoomToGeometry(zoomTarget, {
                  duration: 450,
                  center: useMicronesiaZoom ? micronesiaClusterCenter : null,
                  padding: useWesternEuropeZoom
                    ? 1.25
                    : useNorthernAmericaZoom
                      ? 0.95
                      : useEasternEuropeZoom
                        ? 1.15
                      : useShallowerZoom
                        ? 0.95
                        : useDeeperZoom
                          ? 1.85
                          : isDeepZoom
                            ? 1.2
                            : 1.05,
                  maxScale: useWesternEuropeZoom
                    ? 12
                    : useNorthernAmericaZoom
                      ? 12
                      : useEasternEuropeZoom
                        ? 12
                      : useShallowerZoom
                        ? 8
                        : useDeeperZoom
                          ? 22
                          : isDeepZoom
                          ? 12
                          : 10,
                  xOffset: useMicronesiaZoom
                    ? micronesiaNudge[0]
                    : useEasternEuropeZoom
                      ? -120
                      : 0,
                  yOffset: useMicronesiaZoom
                    ? micronesiaNudge[1]
                    : useNorthernAmericaZoom
                      ? -100
                      : useEasternEuropeZoom
                        ? -150
                        : 0,
                });
                const selectionLabel = `${d.name} (sub-region)`;
                setSelectionDisplay({
                  label: selectionLabel,
                  fact: getSelectionFact({ name: d.name, kind: "subregion" }),
                });
              });

            subregionLabelsGroup
              .classed("is-hidden", false)
              .selectAll("text")
              .data(region.subregions, (d) => d.code)
              .join("text")
              .attr("class", "label subregion-label")
              .attr("x", (d) => {
                const [x, y] = path.centroid(d.geometry);
                if (d.name === "Micronesia") {
                  const estimatedCharWidth = 7.8;
                  return x + d.name.length * estimatedCharWidth * 2;
                }
                return x;
              })
              .attr("y", (d) => {
                const [x, y] = path.centroid(d.geometry);
                if (d.name === "Micronesia") {
                  return y - 10;
                }
                if (d.name === "Western Europe") {
                  return y - 12;
                }
                return y;
              })
              .text((d) => d.name);
          }

          // Draw sub-region countries (hidden until a sub-region is selected).
          function drawSubregionCountries(subregion) {
            subregionCountriesGroup
              .selectAll("path")
              .data(subregion.features)
              .join("path")
              .attr("class", "country")
              .attr("d", path)
              .on("click", function (event, d) {
                event.stopPropagation();
                // Keep the sub-region visible; only highlight the chosen country.
                subregionCountriesGroup.selectAll(".country").classed("is-selected", false);
                d3.select(this).classed("is-selected", true);
                const metadata = subregionByNumeric.get(normalizeNumeric(d.id));
                const subregionName = metadata?.subregion_name || subregion.name;
                const countryName = d.properties.name || "Unknown";
                setSelectionDisplay({
                  label: `${countryName} (${subregionName})`,
                  fact: getCountryFact(countryName),
                });
              });

            countryLabelsGroup
              .classed("is-hidden", false)
              .selectAll("text")
              .data(subregion.features, (d) => d.id)
              .join("text")
              .attr("class", "label country-label")
              .attr("x", (d) => {
                const [x, y] = path.centroid(d);
                if (d.properties.name === "France") {
                  return x + 20;
                }
                const countryOffsets = new Map([
                  ["Antigua and Barbuda", [6, -4]],
                  ["Barbados", [6, 6]],
                  ["Dominica", [-6, -6]],
                  ["Grenada", [8, 8]],
                  ["Saint Kitts and Nevis", [10, -2]],
                  ["Saint Lucia", [6, 10]],
                  ["Saint Vincent and the Grenadines", [10, 12]],
                  ["Trinidad and Tobago", [12, 10]],
                  ["Haiti", [-6, -4]],
                  ["Dominican Republic", [10, 0]],
                ]);
                if (countryOffsets.has(d.properties.name)) {
                  return x + countryOffsets.get(d.properties.name)[0];
                }
                return x;
              })
              .attr("y", (d) => {
                const [x, y] = path.centroid(d);
                if (d.properties.name === "France") {
                  return y - 24;
                }
                const countryOffsets = new Map([
                  ["Antigua and Barbuda", [6, -4]],
                  ["Barbados", [6, 6]],
                  ["Dominica", [-6, -6]],
                  ["Grenada", [8, 8]],
                  ["Saint Kitts and Nevis", [10, -2]],
                  ["Saint Lucia", [6, 10]],
                  ["Saint Vincent and the Grenadines", [10, 12]],
                  ["Trinidad and Tobago", [12, 10]],
                  ["Haiti", [-6, -4]],
                  ["Dominican Republic", [10, 0]],
                ]);
                if (countryOffsets.has(d.properties.name)) {
                  return y + countryOffsets.get(d.properties.name)[1];
                }
                return y;
              })
              .text((d) => d.properties.name || "");
          }

          // -----------------------------
          // 5) Helper functions
          // -----------------------------
          function clearSelections(options = {}) {
            countriesGroup.selectAll(".country").classed("is-selected", false);
            if (!options.keepRegion) {
              regionGroup.selectAll(".region").classed("is-selected", false);
              subregionGroup.classed("is-hidden", true);
              regionLabelsGroup.classed("is-hidden", false);
              subregionLabelsGroup.classed("is-hidden", true);
              countryLabelsGroup.classed("is-hidden", true);
              resetZoom();
            }
            if (!options.keepSubregions) {
              subregionGroup.selectAll(".subregion").classed("is-selected", false);
              subregionGroup.classed("is-hidden", true);
              subregionLabelsGroup.classed("is-hidden", true);
              countryLabelsGroup.classed("is-hidden", true);
            }
            subregionCountriesGroup.selectAll(".country").classed("is-selected", false);
            subregionCountriesGroup.classed("is-hidden", true);
            countryLabelsGroup.classed("is-hidden", true);
            if (!options.keepRegion && !options.keepSubregions) {
              setSelectionDisplay({ label: "None" });
            }
          }

          function setSelectionDisplay({ label, fact } = {}) {
            const selection = label ?? "None";
            const factText = fact ? `<br><span>${fact}</span>` : "";
            d3.select("#selected-country").html(`Selected: ${selection}${factText}`);
          }

          function getSelectionFact(selection) {
            if (!selection) {
              return "";
            }
            const factLookup =
              selection.kind === "region"
                ? regionFacts.get(selection.name)
                : subregionFacts.get(selection.name);
            if (!factLookup) {
              return "";
            }
            return `${selection.name} (${factLookup.code}) — ${factLookup.fact}`;
          }

          function getCountryFact(countryName) {
            const canonicalName = countryAliases.get(countryName) ?? countryName;
            return countryFacts.get(canonicalName) ?? "";
          }

          drawCountries();
          drawRegions();
          setSelectionDisplay({ label: "None" });
        }
      );
    </script>
  </body>
</html>
