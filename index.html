<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Equal Earth World Map (D3.js)</title>
    <style>
      :root {
        color-scheme: light;
        font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
      }

      body {
        margin: 0;
        padding: 24px;
        background: #f7f7fb;
        color: #1f2933;
      }

      h1 {
        margin-bottom: 0.5rem;
        font-size: clamp(1.5rem, 2vw + 1rem, 2.2rem);
      }

      p {
        max-width: 700px;
        line-height: 1.5;
      }

      .map-card {
        background: #ffffff;
        border-radius: 16px;
        box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
        padding: 16px;
        margin-top: 20px;
      }

      svg {
        width: 100%;
        height: auto;
        display: block;
      }

      .country {
        fill: #c9d6f2;
        stroke: #52637a;
        stroke-width: 0.4;
        cursor: pointer;
        transition: fill 150ms ease-in-out;
      }

      .country:hover {
        fill: #8fb0ff;
      }

      .country.is-selected {
        fill: #f97316;
      }

      .selected-label {
        font-weight: 600;
        margin-top: 12px;
        padding: 8px 12px;
        background: #eef2ff;
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <h1>Equal Earth Projection: Interactive Countries Map</h1>
    <p>
      This beginner-friendly demo loads Natural Earth country boundaries using
      <strong>d3@7</strong> and <strong>topojson-client</strong>, then renders them with the
      <strong>Equal Earth</strong> projection. Click a country to highlight it and see its name.
    </p>

    <div class="map-card">
      <svg id="world-map" viewBox="0 0 960 520" aria-label="World map"></svg>
      <div id="selected-country" class="selected-label">Selected country: None</div>
    </div>

    <!-- D3 + TopoJSON libraries (CDN, no build tools required) -->
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
    <script>
      // -----------------------------
      // 1) Basic SVG setup
      // -----------------------------
      const svg = d3.select("#world-map");
      const width = 960;
      const height = 520;

      // -----------------------------
      // 2) Projection + path generator
      // -----------------------------
      // Equal Earth is a good choice for thematic maps because it preserves
      // area well while keeping continents visually familiar.
      const projection = d3.geoEqualEarth().fitSize([width, height], { type: "Sphere" });
      const path = d3.geoPath(projection);

      // -----------------------------
      // 3) Data loading
      // -----------------------------
      // Natural Earth country geometries come from world-atlas (TopoJSON).
      const worldAtlasUrl =
        "https://cdn.jsdelivr.net/npm/world-atlas@2/countries-50m.json";

      d3.json(worldAtlasUrl).then((topology) => {
        // Convert TopoJSON to GeoJSON features so D3 can draw each country.
        const countries = topojson.feature(topology, topology.objects.countries).features;

        // -----------------------------
        // 4) Draw countries
        // -----------------------------
        const countriesGroup = svg.append("g");

        countriesGroup
          .selectAll("path")
          .data(countries)
          .join("path")
          .attr("class", "country")
          .attr("d", path)
          .on("click", function (event, d) {
            // Remove selection from all countries, then select the clicked one.
            countriesGroup.selectAll(".country").classed("is-selected", false);
            d3.select(this).classed("is-selected", true);

            const name = d.properties.name || "Unknown";
            d3.select("#selected-country").text(`Selected country: ${name}`);
          });
      });
    </script>
  </body>
</html>
